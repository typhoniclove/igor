

const mainContent = document.getElementById('main-content');


const pages = {
  home: `
    <div class="prologue" style="text-align: center;">
      <img src="angeshrine/up.gif" width="380">
      <h1>The Witch of Truth</h1>
      <p>
The Witch of Truth - Ange Ushiromiya - is a character from a visual novel series created all the way back 
in 2007, where Ange herself was introduced to us a year later. Umineko When They Cry is a story of murder
 mystery and fantasy. There is obviously more themes rotating around this visual novel, but revealing them
  would be a spoiler itself. Even just seeing this character on my shrine could technically be considered a
   spoiler, if you really want to be cautious. :D
</p>
<p>
So, consider this your warning: 
<span style="color: #fa1100;">
This shrine contains heavy spoilers for Umineko and its ending.
</span>
I won’t hold back. If you’d rather keep the catbox closed, turn back now.
</p>

<p>
Otherwise, welcome!
</p>

<p>
Here, I would like to show and talk about why and how I think Ange is most well-developed and meaningful 
characters in the entire visual novel, but that opinion would be like saying forks were found in a kitchen.
XD
</p> 
<img src="angeshrine/fountain.gif" width="80">
<br><br>
<img src="angeshrine/down.gif" width="380">
    </div>
  `,
  ange: `
    <img src="angeshrine/up.gif" width="380">
    <h1>Ange Ushiromiya</h1>
    <p>Ange grew up in a family already falling apart. Her brother Battler had already left home due to family drama, partly so that when Ange is born, she would have a loving home and family. And even though she only saw him on birthdays and family conferences, they grew to be very close. Then came 1986 the year of the Rokkenjima massacre. Ange stayed home sick, and by the time her cold ended, her entire family was gone.
<br><br>
Eva, her aunt and the sole survivor, took her in. At first, she treated Ange like a daughter, and their relationship started good at first, until the Witch of Miracles, Bernkastel, told Ange that loving Eva meant betraying her real mother, Kyrie. Believing her, Ange pushed Eva away, and by the time she realized the lie, it was too late.
<br><br>
School didn't offer her any comfort either. Everyone knew Ange only as the heiress to a cursed fortune, the last Ushiromiya. The bullying never stopped. Adults treated her like a burden or a prize, and she learned to use her sharp tongue as her only defense.
<br><br>
And then there was the diary. Written by her cousin, Maria, her one fragile link to the family she lost. Through this, she was able to create illusionary versions of Maria, Sakutarou and the Stakes of Purgatory, giving her the title of the Witch of Resurrection. During this time, her life got a bit happier, but that's where the bullying also became harsher, due to her classmates finding out about her illusionary 'fake' friends.
<br><br>
When her pain became too much due to this, she turned on her illusions, denying them one by one until they vanished. And by the time Eva died, Ange had no one left. Her final attempt to learn the truth of Rokkenjima lead her to nothing because Eva refused to tell her anything, telling her to ask her parents who are now in hell.
<br><br>
This is where I think Ange's real journey began. Not just to uncover the truth, but to decide whether knowing it was worth destroying herself for, and she was ready to sacrifice what little she had left just to find out what happened on that day.</p>
    <img src="angeshrine/down.gif" width="380">
  `,
  motives: `
     <img src="angeshrine/up.gif" width="380">
    <h1>Her Motives</h1>
    <p>Like I said before, at first her motives were simple: she just wanted her family back. She was a lonely child who lost everyone she loved in one night. Eva couldn't fill that void, and when Bernkastel manipulated her into rejecting Eva's love, Ange lost her last human connection.
<br><br>
Her grief turned into obsession because she refused to accept a world where her family was gone for no reason. What looked like a desire for "truth" was really her search for closure, a desperate attempt to make sense of the pain. She believed that knowing the truth would heal her, when in reality, it would only destroy her further.
<br><br>
This is why everyone in the meta-world refused to grant her that truth, except Bernkastel, who dangled the closed catbox before her. Inside the meta-world, Ange learned that the "truth" she sought wasn't simple at all. Beatrice, Battler, and even her illusions all represented different ways of understanding it.
<br><br>
In time, Ange realized that denying fantasy, calling it fake, didn't make her stronger. It only isolated her more. Her motive slowly shifted from wanting to expose the truth to wanting to understand why they believed in magic.</p>
<img src="angeshrine/down.gif" width="380">
  `,
  end: `
    <img src="angeshrine/up.gif" width="380">
    <h1>The End</h1>
    <p>By the end of Episode 8, Ange's motive reaches its final form: to live on and carry the love her family left behind. She no longer needed to know the "one truth" of Rokkenjima, because she finally understood there isn't one. The truth isn't something you find. It's something you choose to accept.

When she becomes "Beatrice" in the Magic ending, that's not her giving up, it's her moving forward. She stopped chasing a cruel, absolute truth and instead embraces the warmth that's still left, her family's memories, their love, and her own future.
<br><br>
For years, Ange wanted answers. But in the end, she chose something far harder, and that is forgiveness. She forgave her family, the world, and herself. She realized that even if her past was filled with pain, it didn't have to define what came next. The "magic" she once rejected was about the courage to keep living despite them, and was never about illusions.
<br><br>
Even her new identity as Yukari Kotobuki reflects this. She resurrects herself, just like the Witch of Resurrection would, but this time, not as a witch or a tragic figure, but as someone who finally found peace. Someone who can tell her story without being consumed by it.</p>
<img src="angeshrine/down.gif" width="380">
  `,
  resolution: `
    <img src="angeshrine/up.gif" width="380">
    <h1>Resolution</h1>
    Ange has always been more than just a character to me. Her story of loss and loneliness, and eventual acceptance felt painfully real. I grew up isolated too, with complicated family connections and years of being bullied by my peers. Like her, I spent a lot of time escaping into fantasy, creating little worlds where I felt safe, before denying them, pretending I was past that. But eventually, I came to understand what Ange did, that embracing those parts of myself isn't childish. It's healing. And that's why I love her so much.
<br><br>
Obviously, Ange isn't perfect. She's angry, bitter, and quite self destructive at times, but every mistake and part of her pain & growth makes sense, and by the end, she becomes something far greater than her suffering. She learns to forgive, to live, and to keep believing in warmth even when the world feels cold.
<br><br>
I genuinely believe Ange was the true main character of Umineko. Even if she appears halfway through, she carries the emotional core of the story which is the struggle to accept love, loss, and the meaning of truth. She was the reason I finished reading it at all. I wanted to see where her journey would lead, and the ending she received couldn't have been more perfect.
<br><br>
<span style="color: #ffcb2e;">
Ange deserves to be happy. :)
</span>
<br><br>
    <img src="angeshrine/down.gif" width="380">
  `,
  gallery: `
  <img src="angeshrine/up.gif" width="380">
    <h1>Gallery</h1>
    <h2>Manga covers & panels</h2>
    <p>My favorite covers and panels!</p>
    <div id="manga-gallery">
  <img src="angeshrine/manga/1.png">
  <img src="angeshrine/manga/2.png">
  <img src="angeshrine/manga/3.png">
  <img src="angeshrine/manga/4.png">
  <img src="angeshrine/manga/5.png">
  <img src="angeshrine/manga/6.png">
  <img src="angeshrine/manga/7.png">
  <img src="angeshrine/manga/8.png">
  <img src="angeshrine/manga/9.png">
  <img src="angeshrine/manga/10.png">
  <img src="angeshrine/manga/11.png">
  <img src="angeshrine/manga/12.png">
  <img src="angeshrine/manga/13.png">
  <img src="angeshrine/manga/14.png">
  <img src="angeshrine/manga/15.png">
  <img src="angeshrine/manga/16.png">
  <img src="angeshrine/manga/17.png">
  <img src="angeshrine/manga/18.png">
</div>
<br><br>
<h2>Artwork references</h2>
<p>I tried to compile as many as I could find!</p>
<div id="manga-gallery">
  <img src="angeshrine/references/1.png">
  <img src="angeshrine/references/2.png">
  <img src="angeshrine/references/3.png">
  <img src="angeshrine/references/4.png">
  <img src="angeshrine/references/5.png">
  <img src="angeshrine/references/6.png">
  <img src="angeshrine/references/7.png">
  <img src="angeshrine/references/8.png">
</div>
<br><br>
<h2>TIPS sprites</h2>
<p>Higurashi and Golden Fantasia will be added soon!</p>
<div id="manga-gallery">
  <img src="angeshrine/tips/1.png">
  <img src="angeshrine/tips/2.png">
  <img src="angeshrine/tips/3.png">
  <img src="angeshrine/tips/4.png">
  <img src="angeshrine/tips/5.png">
  <img src="angeshrine/tips/6.png">
  <img src="angeshrine/tips/7.png">
  <img src="angeshrine/tips/8.png">
  <img src="angeshrine/tips/9.png">
  <img src="angeshrine/tips/10.png">
</div>
<br><br>
<p>More to be added soon!</p>
<br><br>
    <img src="angeshrine/down.gif" width="380">

<!-- Lightbox overlay -->
<div id="lightbox">
  <span id="close">&times;</span>
  <img id="lightbox-img" src="">
</div>
  `,
  quotes: `
  <img src="angeshrine/up.gif" width="380">
    <h2>Quotes</h2>
    <p>"See you again, have a nice day."</p>
    <p>"People tend to push the pain they're burdened with onto other people."</p>
    <p>"Even if you have two of the exact same person, they could change enormously depending on their
    upbringing."</p>
    <p>"Children learn how to work hard because they want to be praised by their parents. 
    ....Of course, that's why I never learned."</p>
    <p>"...To me, your happiness is...too painful, Maria onee-chan."</p>
    <p>"My life is trash."</p>
    <p>"Criticism of yourself as you're observed by others doesn't matter. If your
    existence is firmly acknowledge by yourself, that's enough. If you can live with confidence
    in yourself, surely you can accept any kind of lifestyle."</p>
    <p>"Win or lose. That's all you've been given. A tie during the process of reaching that point will
    probably be permitted."</p>
    <p>"...I had no idea that pancakes would become explosive if cooked for too long. Good going, me... 
    I guess there was a reason I got such low scores in Home Ec."</p>
    <br><br>
    <img src="angeshrine/down.gif" width="380">
  `,
  credits: `
  <img src="angeshrine/up.gif" width="380">
       <h2>Credits</h2>
       <p>Here I'll link all of the fanarts to their rightful owners, and also link where I got the resources
       in the gallery section.</p>
       <p>This is a work in progress, for now.</p>
  
  <img src="angeshrine/down.gif" width="380">
</div>
  `,
  fanarts: `
  <img src="angeshrine/up.gif" width="380">
  <h2>Fanarts</h2>
  <p>All fanarts here belong and are credited to their rightful owners! If you want your artwork taken down from my site, please let me know!</p>

  <div id="fanarts-gallery">
    <img src="angeshrine/fanarts/0.jpg">
    <img src="angeshrine/fanarts/1.jpg">
    <img src="angeshrine/fanarts/2.jpg">
    <img src="angeshrine/fanarts/3.jpg">
    <img src="angeshrine/fanarts/4.png">
    <img src="angeshrine/fanarts/5.png">
    <img src="angeshrine/fanarts/6.png">
    <img src="angeshrine/fanarts/7.png">
    <img src="angeshrine/fanarts/8.png">
    <img src="angeshrine/fanarts/9.png">
    <img src="angeshrine/fanarts/10.png">
    <img src="angeshrine/fanarts/11.png">
    <img src="angeshrine/fanarts/12.png">
    <img src="angeshrine/fanarts/13.png">
    <img src="angeshrine/fanarts/14.png">
    <img src="angeshrine/fanarts/15.png">
    <img src="angeshrine/fanarts/16.png">
    <img src="angeshrine/fanarts/17.png">
    <img src="angeshrine/fanarts/18.png">
    <img src="angeshrine/fanarts/19.png">
    <img src="angeshrine/fanarts/20.png">
    <img src="angeshrine/fanarts/21.png">
    <img src="angeshrine/fanarts/22.png">
    <img src="angeshrine/fanarts/23.png">
    <img src="angeshrine/fanarts/24.png">
    <img src="angeshrine/fanarts/25.png">
    <img src="angeshrine/fanarts/26.png">
    <img src="angeshrine/fanarts/27.png">
    <img src="angeshrine/fanarts/28.png">
    <img src="angeshrine/fanarts/29.png">
    <img src="angeshrine/fanarts/30.png">
    <img src="angeshrine/fanarts/31.png">
    <img src="angeshrine/fanarts/32.png">
    <img src="angeshrine/fanarts/33.png">
    <img src="angeshrine/fanarts/34.png">
    <img src="angeshrine/fanarts/35.jpg">
  </div>
  <br><br>
  <img src="angeshrine/down.gif" width="380">

  <!-- Lightbox overlay -->
  <div id="fanart-lightbox">
    <span id="fanart-close">&times;</span>
    <img id="fanart-lightbox-img" src="">
  </div>
  `
};

function loadPage(page) {
  if (pages[page]) {
    mainContent.innerHTML = pages[page];
  }
}







// 💫 this line makes the Prologue load immediately
loadPage('home');


function setupGalleryLightbox() {
  const galleryImgs = document.querySelectorAll('#manga-gallery img');
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-img');
  const closeBtn = document.getElementById('close');

  galleryImgs.forEach(img => {
    img.addEventListener('click', () => {
      lightbox.style.display = 'flex';
      lightboxImg.src = img.src;   // show original image
    });
  });

  closeBtn.addEventListener('click', () => {
    lightbox.style.display = 'none';
  });

  lightbox.addEventListener('click', e => {
    if (e.target === lightbox) {
      lightbox.style.display = 'none';
    }
  });
}



function loadPage(page) {
  if (pages[page]) {
    mainContent.innerHTML = pages[page];

    if (page === 'gallery') {
      setupGalleryLightbox();
    } else if (page === 'fanarts') {
      setupFanartLightbox();
    }
  }
}







function setupFanartLightbox() {
  const fanartImgs = document.querySelectorAll('#fanarts-gallery img');
  const lightbox = document.getElementById('fanart-lightbox');
  const lightboxImg = document.getElementById('fanart-lightbox-img');
  const closeBtn = document.getElementById('fanart-close');

  fanartImgs.forEach(img => {
    img.addEventListener('click', () => {
      lightbox.style.display = 'flex';
      lightboxImg.src = img.src;
    });
  });

  closeBtn.addEventListener('click', () => {
    lightbox.style.display = 'none';
  });

  lightbox.addEventListener('click', e => {
    if (e.target === lightbox) {
      lightbox.style.display = 'none';
    }
  });
}


function toggleEpisode(id) {
  const section = document.getElementById(id);
  const arrow = section.previousElementSibling.querySelector('.arrow');

  if (section.style.display === "none" || section.style.display === "") {
    section.style.display = "block";
    arrow.textContent = "▲"; // flip arrow up
  } else {
    section.style.display = "none";
    arrow.textContent = "▼"; // arrow down
  }
}

const bgAudio = document.getElementById("bg-audio");
const trackList = document.getElementById("track-list");
const bgPlayer = document.getElementById("bg-player");
const currentTrackSpan = document.getElementById("current-track");

// map tracks to friendly names
const tracks = [
  { src: 'angeshrine/soundtrack/1rose.mp3', name: 'Episode 1 - Rose' },
  { src: 'angeshrine/soundtrack/2sea.mp3', name: 'Episode 1 - Sea' },
  { src: 'angeshrine/soundtrack/3novelette.mp3', name: 'Episode 1 - Novelette' },
  { src: 'angeshrine/soundtrack/4hope.mp3', name: 'Episode 1 - Hope' },
  { src: 'angeshrine/soundtrack/5steadypace.mp3', name: 'Episode 1 - Steady Pace' },
  { src: 'angeshrine/soundtrack/6Fortitude.mp3', name: 'Episode 1 - Fortitude' },
  { src: 'angeshrine/soundtrack/7witchingold.mp3', name: 'Episode 1 - Witch In Gold' },
  { src: 'angeshrine/soundtrack/8fishyaroma.mp3', name: 'Episode 1 - Fishy Aroma' },
  { src: 'angeshrine/soundtrack/9path.mp3', name: 'Episode 1 - Path' },
  { src: 'angeshrine/soundtrack/10worldend.mp3', name: 'Episode 1 - Worldend' },
  { src: 'angeshrine/soundtrack/11voiceless.mp3', name: 'Episode 1 - Voiceless' },
  { src: 'angeshrine/soundtrack/12deadangle.mp3', name: 'Episode 1 - Dead Angle' },

   { src: 'angeshrine/soundtrack/13cage.mp3', name: 'Episode 2 - Cage' },
  { src: 'angeshrine/soundtrack/14goldensneer.mp3', name: 'Episode 2 - Golden Sneer' },
  { src: 'angeshrine/soundtrack/15melody.mp3', name: 'Episode 2 - Melody' },
  { src: 'angeshrine/soundtrack/16blacklilliana.mp3', name: 'Episode 2 - Black Lilliana' },
  { src: 'angeshrine/soundtrack/17overthesky.mp3', name: 'Episode 2 - Over The Sky' },

   { src: 'angeshrine/soundtrack/18haruka.mp3', name: 'Episode 3 - Haruka (Distant)' },
  { src: 'angeshrine/soundtrack/19psychorus.mp3', name: 'Episode 3 - Psy-Chorus' },
  { src: 'angeshrine/soundtrack/20far.mp3', name: 'Episode 3 - Far' },
  { src: 'angeshrine/soundtrack/21haze.mp3', name: 'Episode 3 - Haze' },
  { src: 'angeshrine/soundtrack/22happinessofmarionette.mp3', name: 'Episode 3 - Happiness Of Marionette' },
  { src: 'angeshrine/soundtrack/23meltingaway.mp3', name: 'Episode 3 - Melting Away' },
  { src: 'angeshrine/soundtrack/24soulofsoul.mp3', name: 'Episode 3 - Soul Of Soul' },
  { src: 'angeshrine/soundtrack/25thanksforbeingborn.mp3', name: 'Episode 3 - Thanks For Being Born' },
  { src: 'angeshrine/soundtrack/26wingless.mp3', name: 'Episode 3 - Wingless' },

   { src: 'angeshrine/soundtrack/27monochromeclock.mp3', name: 'Episode 4 - Monochrome Clock' },
  { src: 'angeshrine/soundtrack/28apathy.mp3', name: 'Episode 4 - Apathy' },
  { src: 'angeshrine/soundtrack/29parallel.mp3', name: 'Episode 4 - Parallel' },
  { src: 'angeshrine/soundtrack/30fstyle.mp3', name: 'Episode 4 - F Style' },
  { src: 'angeshrine/soundtrack/31happymaria.mp3', name: 'Episode 4 - Happy Maria! (Instrumental)' },
  { src: 'angeshrine/soundtrack/32dir.mp3', name: 'Episode 4 - Dir' },
  
   { src: 'angeshrine/soundtrack/33one.mp3', name: 'Episode 5 - One' },
  { src: 'angeshrine/soundtrack/34spiral.mp3', name: 'Episode 5 - Spiral' },
  { src: 'angeshrine/soundtrack/35prouddust.mp3', name: 'Episode 5 - Proud-Dust' },
  { src: 'angeshrine/soundtrack/36discolor.mp3', name: 'Episode 5 - Discolor' },

   { src: 'angeshrine/soundtrack/37asinglemoment.mp3', name: 'Episode 6 - A Single Moment' },
  { src: 'angeshrine/soundtrack/38mydear.mp3', name: 'Episode 6 - My Dear' },
  { src: 'angeshrine/soundtrack/39loreley.mp3', name: 'Episode 6 - Loreley' },

   { src: 'angeshrine/soundtrack/40le4octobre.mp3', name: 'Episode 7 - Le 4 Octobre' },
  { src: 'angeshrine/soundtrack/41l&dcirculation.mp3', name: 'Episode 7 - L&D Circulation' },
  { src: 'angeshrine/soundtrack/42-7weights.mp3', name: 'Episode 7 - 7 Weights' },
  { src: 'angeshrine/soundtrack/43fall.mp3', name: 'Episode 7 - Fall' },
  { src: 'angeshrine/soundtrack/44farflat.mp3', name: 'Episode 7 - Far (Flat)' },
  { src: 'angeshrine/soundtrack/45s-he-end.mp3', name: 'Episode 7 - S-He-End' },

   { src: 'angeshrine/soundtrack/46encounse.mp3', name: 'Episode 8 - Encounse' }
];

let currentIndex = -1;

function playTrack(src) {
  const trackIndex = tracks.findIndex(t => t.src === src);
  if (trackIndex !== -1) {
    currentIndex = trackIndex;
    bgAudio.src = tracks[currentIndex].src;
    bgAudio.play();
    currentTrackSpan.textContent = tracks[currentIndex].name; // friendly name
  }
}

function toggleTrackList() {
  if (trackList.style.display === "none") {
    trackList.style.display = "block";
  } else {
    trackList.style.display = "none";
  }
}

function prevTrack() {
  if (currentIndex > 0) currentIndex--;
  else currentIndex = tracks.length - 1;
  playTrack(tracks[currentIndex].src);
}

function nextTrack() {
  if (currentIndex < tracks.length - 1) currentIndex++;
  else currentIndex = 0;
  playTrack(tracks[currentIndex].src);
}